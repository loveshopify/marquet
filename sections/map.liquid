{% include 'include-map' %}

{% schema %}

{
  "name": "Map",
  "class": "map-section",
  "settings": [
    {
      "type": "text",
      "id": "deliver_state_original",
      "label": "Default Text for Delivery State"
    },
    {
      "type": "text",
      "id": "success_state_original",
      "label": "Success Text for Delivery State"
    },
    {
      "type": "text",
      "id": "fail_state_original",
      "label": "Fail Text for Delivery State"
    },
    {
      "type": "checkbox",
      "id": "wide_display",
      "label": "Wide display",
      "default": true
    },
    {
      "type": "richtext",
      "id": "zip_code",
      "label": "Zip Codes"
    },
    {
      "type": "text",
      "id": "map_address",
      "label": "Address",
      "info": "Google Maps will find the exact location"
    },
    {
      "type": "range",
      "id": "map_height",
      "min": 300,
      "max": 600,
      "step": 10,
      "unit": "px",
      "label": "Map height",
      "default": 400
    },
    {
      "type": "range",
      "id": "zoom_level",
      "min": 1,
      "max": 20,
      "step": 1,
      "unit": "x",
      "label": "Map zoom level",
      "default": 16
    },
    {
      "type": "image_picker",
      "id": "map_image",
      "label": "Image",
      "info": "Displayed when map isn't loaded"
    },
    {
      "type": "header",
      "content": "API key"
    },
    {
      "type": "text",
      "id": "api_key",
      "label": "Google Maps API key",
      "info": "Youâ€™ll need to [register a Google Maps API Key](https://help.shopify.com/manual/using-themes/troubleshooting/map-section-api-key) to display the map"
    },
    {
      "type": "checkbox",
      "id": "show_pin",
      "label": "Show pin",
      "info": "Requires use of API key",
      "default": true
    },
    {
      "type": "select",
      "id": "map_style",
      "label": "Map color scheme",
      "options": [
        {
          "value": "default",
          "label": "Default"
        },
        {
          "value": "aubergine",
          "label": "Aubergine"
        },
        {
          "value": "night",
          "label": "Night"
        },
        {
          "value": "retro",
          "label": "Retro"
        },
        {
          "value": "silver",
          "label": "Silver"
        }
      ],
      "default": "default",
      "info": "Requires use of API key"
    }
  ],
  "presets": [
    {
      "name": "Map",
      "category": "Store information"
    }
  ]
}

{% endschema %}

<script>
  const zip_code = '{{ section.settings.zip_code | escape }}';
  $(document).on('click', '.zip-code_btn', function(){
    const input_code = $('.zip-code_input').val();
    $('.zip-code-text').html(input_code);
    if(zip_code.indexOf(input_code) != -1) {
      $('.deliver-state').html("{{ section.settings.success_state_original }}");
    } else {
      $('.deliver-state').html("{{ section.settings.fail_state_original }}");
    }
  });
</script>